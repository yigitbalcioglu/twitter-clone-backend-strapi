{"version":3,"file":"useDocumentation-qGMKeeFT.js","sources":["../../admin/src/utils/getTrad.js","../../admin/src/hooks/useDocumentation.js"],"sourcesContent":["import pluginId from '../pluginId';\n\nconst getTrad = (id) => `${pluginId}.${id}`;\n\nexport default getTrad;\n","import { useEffect } from 'react';\n\nimport { useFetchClient, useNotification, useAPIErrorHandler } from '@strapi/helper-plugin';\nimport { useMutation, useQuery } from 'react-query';\n\nimport pluginId from '../pluginId';\nimport getTrad from '../utils/getTrad';\n\nexport const useDocumentation = () => {\n  const toggleNotification = useNotification();\n  const { del, post, put, get } = useFetchClient();\n\n  const { formatAPIError } = useAPIErrorHandler();\n\n  const { isLoading, isError, data, refetch, error } = useQuery(\n    ['get-documentation', pluginId],\n    async () => {\n      const { data } = await get(`/${pluginId}/getInfos`);\n\n      return data;\n    }\n  );\n\n  useEffect(() => {\n    if (isError && error) {\n      toggleNotification({\n        type: 'warning',\n        message: error ? formatAPIError(error) : { id: 'notification.error' },\n      });\n    }\n  }, [isError, error, toggleNotification, formatAPIError]);\n\n  const handleError = (err) => {\n    toggleNotification({\n      type: 'warning',\n      message: formatAPIError(err),\n    });\n  };\n\n  const handleSuccess = (type, tradId, defaultMessage) => {\n    refetch();\n    toggleNotification({\n      type,\n      message: { id: getTrad(tradId), defaultMessage },\n    });\n  };\n\n  const deleteMutation = useMutation(\n    ({ prefix, version }) => del(`${prefix}/deleteDoc/${version}`),\n    {\n      onSuccess: () =>\n        handleSuccess('info', 'notification.delete.success', 'Successfully deleted documentation'),\n      onError: handleError,\n    }\n  );\n\n  const submit = useMutation(({ prefix, body }) => put(`${prefix}/updateSettings`, body), {\n    onSuccess: () =>\n      handleSuccess('success', 'notification.update.success', 'Successfully updated settings'),\n    onError: handleError,\n  });\n\n  const regenerate = useMutation(\n    ({ prefix, version }) => post(`${prefix}/regenerateDoc`, { version }),\n    {\n      onSuccess: () =>\n        handleSuccess(\n          'info',\n          'notification.generate.success',\n          'Successfully generated documentation'\n        ),\n      onError: handleError,\n    }\n  );\n\n  return { data, isLoading, isError, remove: deleteMutation, submit, regenerate };\n};\n"],"names":["pluginId","useNotification","useFetchClient","useAPIErrorHandler","useQuery","data","useEffect","useMutation"],"mappings":";;;;;AAEK,MAAC,UAAU,CAAC,OAAO,GAAGA,MAAAA,QAAQ,IAAI,EAAE;ACM7B,MAAC,mBAAmB,MAAM;AACpC,QAAM,qBAAqBC,aAAAA;AAC3B,QAAM,EAAE,KAAK,MAAM,KAAK,IAAG,IAAKC,aAAAA;AAEhC,QAAM,EAAE,mBAAmBC,aAAAA;AAE3B,QAAM,EAAE,WAAW,SAAS,MAAM,SAAS,MAAK,IAAKC,WAAQ;AAAA,IAC3D,CAAC,qBAAqBJ,MAAAA,QAAQ;AAAA,IAC9B,YAAY;AACV,YAAM,EAAE,MAAAK,MAAM,IAAG,MAAM,IAAI,IAAIL,MAAQ,QAAA,WAAW;AAElD,aAAOK;AAAA,IACR;AAAA,EACL;AAEEC,QAAAA,UAAU,MAAM;AACd,QAAI,WAAW,OAAO;AACpB,yBAAmB;AAAA,QACjB,MAAM;AAAA,QACN,SAAS,QAAQ,eAAe,KAAK,IAAI,EAAE,IAAI,qBAAsB;AAAA,MAC7E,CAAO;AAAA,IACF;AAAA,EACF,GAAE,CAAC,SAAS,OAAO,oBAAoB,cAAc,CAAC;AAEvD,QAAM,cAAc,CAAC,QAAQ;AAC3B,uBAAmB;AAAA,MACjB,MAAM;AAAA,MACN,SAAS,eAAe,GAAG;AAAA,IACjC,CAAK;AAAA,EACL;AAEE,QAAM,gBAAgB,CAAC,MAAM,QAAQ,mBAAmB;AACtD;AACA,uBAAmB;AAAA,MACjB;AAAA,MACA,SAAS,EAAE,IAAI,QAAQ,MAAM,GAAG,eAAgB;AAAA,IACtD,CAAK;AAAA,EACL;AAEE,QAAM,iBAAiBC,WAAW;AAAA,IAChC,CAAC,EAAE,QAAQ,QAAO,MAAO,IAAI,GAAG,MAAM,cAAc,OAAO,EAAE;AAAA,IAC7D;AAAA,MACE,WAAW,MACT,cAAc,QAAQ,+BAA+B,oCAAoC;AAAA,MAC3F,SAAS;AAAA,IACV;AAAA,EACL;AAEE,QAAM,SAASA,WAAAA,YAAY,CAAC,EAAE,QAAQ,KAAI,MAAO,IAAI,GAAG,MAAM,mBAAmB,IAAI,GAAG;AAAA,IACtF,WAAW,MACT,cAAc,WAAW,+BAA+B,+BAA+B;AAAA,IACzF,SAAS;AAAA,EACb,CAAG;AAED,QAAM,aAAaA,WAAW;AAAA,IAC5B,CAAC,EAAE,QAAQ,QAAO,MAAO,KAAK,GAAG,MAAM,kBAAkB,EAAE,SAAS;AAAA,IACpE;AAAA,MACE,WAAW,MACT;AAAA,QACE;AAAA,QACA;AAAA,QACA;AAAA,MACD;AAAA,MACH,SAAS;AAAA,IACV;AAAA,EACL;AAEE,SAAO,EAAE,MAAM,WAAW,SAAS,QAAQ,gBAAgB,QAAQ;AACrE;;;"}